Central Logging - SCP, Guardrails


AC1: SCP terraform code created and deployed to ensure logs cannot be disabled, deleted or tampered with. 

AC2: Determine which Control Tower Guardrails are needed for central logging.

AC3 : conditional deny rule - specific role can override.

TSS and NIST controls that relate to the Centralized audit logging documented and configurations identified in code to make resources compliant. Links to bank std retention policy for logs. Enforce retention in configuration (s3 bucket lifecycle policy has maximum retention period move the logs into glacier / Infrequent Access - follow industry best practice).
https://www.perplexity.ai/search/c5e30c3c-0ea8-4df5-bd13-7de1e4530954?s=u


---
data:
  aws_iam_policy_document:
    deny_log_modification:
      statement:
        - sid: DenyLogModification
          effect: Deny
          actions:
            - logs:DeleteLogGroup
            - logs:DeleteLogStream
            - logs:DisassociateKmsKey
            - logs:PutRetentionPolicy
            - logs:StopQuery
            - logs:UpdateLogDelivery
            - logs:UpdateLogGroup
            - logs:UpdateLogStream
            - logs:UpdateMetricFilter
            - logs:UpdateSubscriptionFilter
          resources:
            - "*"
          condition:
            test: StringEquals
            variable: "aws:RequestTag/AllowLogModification"
            values:
              - "true"
resource:
  aws_organizations_policy:
    deny_log_modification:
      name: "${join("", local.organizational_unit_names)}DenyLogModificationSCP"
      description: "Prevents disabling, deleting, or tampering with logs."
      content: "${data.aws_iam_policy_document.deny_log_modification.json}"
      tags: "${var.tags}"
  aws_organizations_policy_attachment:
    deny_log_modification:
      policy_id: "${aws_organizations_policy.deny_log_modification.id}"
      target_id: "${local.target_organizational_unit_id}"
